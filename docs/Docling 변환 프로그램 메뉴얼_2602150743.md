# Docling ë³€í™˜ í”„ë¡œê·¸ë¨ ë§¤ë‰´ì–¼ (ìµœì¢…ë³¸)

- ë¬¸ì„œ ë²„ì „: **v43.0 (2026-02-15)**
- ëŒ€ìƒ: Docling ê¸°ë°˜ PDF â†’ í…ìŠ¤íŠ¸ ë°ì´í„°ì…‹ ë³€í™˜ ì‹œìŠ¤í…œ êµ¬ì¶•/ìš´ì˜ ë‹´ë‹¹ì
- ëª©ì : ê¸°ì¡´ ë§¤ë‰´ì–¼ì˜ ê²€í†  ì´ìŠˆ(ì‹¤í–‰ ë¶ˆê°€ëŠ¥í•œ ì´ìŠ¤ì¼€ì´í”„ ì½”ë“œ, ì„¤ì¹˜ ì‹ ë¢°ì„± ë¶€ì¡±, ì˜ˆì™¸ ì€ë‹‰, ì´ë ¥ ë¶ˆì¼ì¹˜)ë¥¼ ë°˜ì˜í•œ **ì‹¤í–‰ ê°€ëŠ¥í•œ ìš´ì˜ í‘œì¤€** ì œê³µ

---

## 1) ì‹œìŠ¤í…œ ê°œìš”

ë³¸ ì‹œìŠ¤í…œì€ ê¸°êµ¬ ì„¤ê³„ PDF ë¬¸ì„œë¥¼ LLM í•™ìŠµìš© í…ìŠ¤íŠ¸ë¡œ ë³€í™˜í•˜ëŠ” ETL ë„êµ¬ì…ë‹ˆë‹¤.

í•µì‹¬ ëª©í‘œ:
1. ì¬í˜„ ê°€ëŠ¥í•œ ì„¤ì¹˜
2. ì¥ì•  ë°œìƒ ì‹œ ì›ì¸ ì¶”ì  ê°€ëŠ¥í•œ ë¡œê·¸
3. ì¬ì‹œì‘/ë³µêµ¬ ì •ì±…ì˜ ëª…í™•í•œ ì œì–´
4. ë¬¸ì„œì™€ ì‹¤ì œ ë™ì‘ì˜ ì¼ì¹˜

> ì¤‘ìš”: ì„¤ì¹˜ GUIëŠ” í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œë§Œ ë™ì‘í•  ìˆ˜ ìˆìœ¼ë‚˜, ì‹¤í–‰ ì—”ì§„ì€ `docling`, `torch`, `psutil` ê°™ì€ ì™¸ë¶€ íŒ¨í‚¤ì§€ì— ì˜ì¡´í•©ë‹ˆë‹¤.

---

## 2) ì´ë²ˆ ìµœì¢… ê°œì •ì—ì„œ ë°˜ì˜í•œ ì‚¬í•­

### A. ë¬¸ì„œ ì‹ ë¢°ì„±
- ê¸°ì¡´ â€œì½”ë“œ ë³µë¶™ ì„¤ì¹˜â€ ì¤‘ì‹¬ ì§€ì¹¨ì„ ì œê±°í•˜ê³ , ì‹¤ì œ íŒŒì¼ ë‹¨ìœ„ ìš´ì˜ ì›ì¹™ìœ¼ë¡œ ë³€ê²½
- Google ê²€ìƒ‰ ë§í¬ ì œê±°, ê³µì‹ ë°°í¬ URL ì‚¬ìš©
- ë²„ì „/ì´ë ¥ì€ ë¬¸ì„œ ë³¸ë¬¸ ìš”ì•½ + ë³„ë„ ë³€ê²½ì´ë ¥ íŒŒì¼(`CHANGELOG.md`) ê´€ë¦¬ ê¶Œì¥

### B. ì„¤ì¹˜/ìš´ì˜ ì•ˆì •ì„±
- `shell=True` ë‚¨ìš© ê¸ˆì§€ (`subprocess.run([...], shell=False, check=True)` ê¶Œì¥)
- `except: pass` ê¸ˆì§€ (`except Exception as e` + ë¡œê·¸ ê¸°ë¡ í•„ìˆ˜)
- ìë™ ì¬ì‹œì‘ì€ **íšŸìˆ˜ ì œí•œ + ì¿¨ë‹¤ìš´** ì •ì±… ì ìš© ê¶Œì¥

### C. êµ¬ì¡° í‘œì¤€í™”
- ì„¤ì¹˜ê¸°/ì‹¤í–‰ê¸°/ê³µí†µ ëª¨ë“ˆ ë¶„ë¦¬
- ë¡œê·¸ íŒŒì¼ ì˜ì†í™” (`logs/installer.log`, `logs/runtime.log`)

---

## 3) ê¶Œì¥ í”„ë¡œì íŠ¸ êµ¬ì¡° (ìµœì¢…)

```text
Docling/
â”œâ”€ README.md
â”œâ”€ CHANGELOG.md
â”œâ”€ requirements.lock
â”œâ”€ src/
â”‚  â”œâ”€ installer/
â”‚  â”‚  â””â”€ install_manager.pyw
â”‚  â”œâ”€ runner/
â”‚  â”‚  â””â”€ runner_app.pyw
â”‚  â””â”€ common/
â”‚     â”œâ”€ config.py
â”‚     â”œâ”€ logging_utils.py
â”‚     â””â”€ recovery.py
â”œâ”€ logs/
â”œâ”€ tests/
â”‚  â”œâ”€ test_config.py
â”‚  â””â”€ test_recovery.py
â””â”€ docs/
   â””â”€ Docling ë³€í™˜ í”„ë¡œê·¸ë¨ ë©”ë‰´ì–¼_2602150743.md
```

---

## 4) ì„¤ì¹˜ ê°€ì´ë“œ (ìˆ˜ì • ì™„ë£Œ)

### 4.1 ì‚¬ì „ ì¤€ë¹„
1. Python 3.12.x ì„¤ì¹˜
   - ê³µì‹ URL: `https://www.python.org/downloads/windows/`
   - ì„¤ì¹˜ ì‹œ **Add python.exe to PATH** ì²´í¬
2. ì¸í„°ë„· ì—°ê²° ë° ë””ìŠ¤í¬ ì—¬ìœ  ê³µê°„ í™•ì¸
3. GPU ì‚¬ìš© ì‹œ NVIDIA ë“œë¼ì´ë²„/CUDA í˜¸í™˜ì„± ì‚¬ì „ í™•ì¸

### 4.2 ê°€ìƒí™˜ê²½ ìƒì„±
```bash
python -m venv .venv
.venv\Scripts\activate
python -m pip install --upgrade pip
```

### 4.3 ì˜ì¡´ì„± ì„¤ì¹˜ (ê¶Œì¥ ìˆœì„œ)
```bash
pip install psutil pillow
pip install docling
# GPU í•„ìš” ì‹œ, í™˜ê²½ì— ë§ëŠ” torch ì„¤ì¹˜ ì¸ë±ìŠ¤ ì‚¬ìš©
```

> ìš´ì˜ í™˜ê²½ë³„ë¡œ `requirements.lock`ë¥¼ ê³ ì •í•˜ì—¬ ì¬í˜„ì„±ì„ í™•ë³´í•©ë‹ˆë‹¤.

---

## 5) ì‹¤í–‰ ê°€ì´ë“œ

1. ì…ë ¥ í´ë”(ì›ë³¸ PDF)ì™€ ì¶œë ¥ í´ë” ì§€ì •
2. ì˜µì…˜ ì„¤ì •
   - ê°•ì œ OCR
   - ë³‘ë ¬ ì²˜ë¦¬(ë¦¬ì†ŒìŠ¤ ìƒí™©ì— ë§ì¶¤)
   - ìë™ ì¬ì‹œì‘(ê¶Œì¥: ê¸°ë³¸ OFF, ìš´ì˜ ì •ì±… ìŠ¹ì¸ í›„ ON)
3. ë³€í™˜ ì‹œì‘
4. ì™„ë£Œ í›„ `report_manifest.csv`ì™€ ë¡œê·¸ í™•ì¸

---

## 6) í•„ìˆ˜ ìš´ì˜ ì •ì±…

### 6.1 ì˜ˆì™¸ ì²˜ë¦¬ ì •ì±…
- ê¸ˆì§€: `except: pass`
- í•„ìˆ˜:
```python
try:
    ...
except Exception as e:
    logger.exception("ì‘ì—… ì‹¤íŒ¨: %s", e)
    raise
```

### 6.2 í”„ë¡œì„¸ìŠ¤ í˜¸ì¶œ ì •ì±…
- ê¸ˆì§€: ë¦¬ìŠ¤íŠ¸ ì¸ì + `shell=True` í˜¼ìš©
- ê¶Œì¥:
```python
subprocess.run([python_exe, "-m", "venv", venv_dir], check=True, shell=False)
```

### 6.3 ìë™ ì¬ì‹œì‘ ì •ì±…
- ìµœëŒ€ ì¬ì‹œì‘ íšŸìˆ˜(ì˜ˆ: 3íšŒ)
- ì¬ì‹œë„ ê°„ê²©(ì˜ˆ: 5ì´ˆ, 15ì´ˆ, 30ì´ˆ)
- ì´ˆê³¼ ì‹œ ì¤‘ì§€ í›„ ì‚¬ìš©ì ì•Œë¦¼

---

## 7) ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ì„¤ì¹˜ê¸°ê°€ í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë§Œìœ¼ë¡œ ê¸°ë™ë˜ëŠ”ê°€?
- [ ] ì‹¤í–‰ê¸° ì˜ì¡´ì„± ì„¤ì¹˜ ì‹¤íŒ¨ ì‹œ ì›ì¸ ë¡œê·¸ê°€ ë‚¨ëŠ”ê°€?
- [ ] `except: pass`ê°€ ì½”ë“œë² ì´ìŠ¤ì— ë‚¨ì•„ìˆì§€ ì•Šì€ê°€?
- [ ] `shell=True`ê°€ í•„ìš”í•œ íŠ¹ë³„í•œ ê·¼ê±°ê°€ ìˆëŠ”ê°€?
- [ ] ìë™ ì¬ì‹œì‘ ë£¨í”„ ë°©ì§€ ì œí•œì´ ì ìš©ë˜ì—ˆëŠ”ê°€?
- [ ] ë¬¸ì„œì˜ ì„¤ì¹˜ ì ˆì°¨ì™€ ì‹¤ì œ ì‹¤í–‰ ì ˆì°¨ê°€ ì¼ì¹˜í•˜ëŠ”ê°€?

---

## 8) ì¥ì•  ëŒ€ì‘ (ìš”ì•½)

### ì„¤ì¹˜ê°€ ë¬´ë°˜ì‘ì¼ ë•Œ
- Python ì—°ê²° í”„ë¡œê·¸ë¨ í™•ì¸
- PATH ë“±ë¡ í™•ì¸
- ì„¤ì¹˜ ë¡œê·¸(`logs/installer.log`) í™•ì¸

### ë³€í™˜ ì¤‘ ë°˜ë³µ í¬ë˜ì‹œ
- ìë™ ì¬ì‹œì‘ íšŸìˆ˜ ì œí•œ ë™ì‘ ì—¬ë¶€ í™•ì¸
- ì§ì „ ì‹¤íŒ¨ íŒŒì¼/ì˜µì…˜/ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸
- GPU ì˜µì…˜ OFF í›„ ì¬ì‹¤í–‰ìœ¼ë¡œ ì›ì¸ ë¶„ë¦¬

### ê²°ê³¼ í’ˆì§ˆ ì €í•˜
- ê°•ì œ OCR ì˜µì…˜/ìŠ¤ì¼€ì¼ ì¡°ì •
- ë¬¸ì œ PDFë¥¼ ê²©ë¦¬ í›„ ì¬ì²˜ë¦¬ íì—ì„œ ë¶„ë¦¬

---

## 9) ë²„ì „ ì´ë ¥ (ìš”ì•½)

- v43.0: ë§¤ë‰´ì–¼ ì „ë©´ ì •ë¦¬(ê²€í† ì‚¬í•­ ë°˜ì˜ ì™„ë£Œ), ìš´ì˜ í‘œì¤€/ì •ì±…í™”
- v42.1: ì„¤ì¹˜ê¸° í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬í™”(ë¬´ë°˜ì‘ ì´ìŠˆ ëŒ€ì‘)
- v42.0 ì´í•˜: ê¸°ì¡´ ê¸°ëŠ¥ ì´ë ¥ì€ ë³„ë„ ë³€ê²½ì´ë ¥ìœ¼ë¡œ ê´€ë¦¬ ê¶Œì¥

---

## 10) ê²°ë¡ 

ì´ ìµœì¢…ë³¸ì€ â€œí•œ íŒŒì¼ ë³µë¶™í˜• ë§¤ë‰´ì–¼â€ì´ ì•„ë‹Œ, **ì¬í˜„ ê°€ëŠ¥í•œ ì„¤ì¹˜Â·ìš´ì˜ ê¸°ì¤€ ë¬¸ì„œ**ë¥¼ ëª©í‘œë¡œ ì •ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.
ë‹¤ìŒ ë‹¨ê³„ëŠ” ì‹¤ì œ ì½”ë“œ ì €ì¥ì†Œ(`src/installer`, `src/runner`, `src/common`)ë¡œ ë¶„ë¦¬ ë°˜ì˜í•˜ì—¬ ë¬¸ì„œì™€ êµ¬í˜„ì„ 1:1ë¡œ ì¼ì¹˜ì‹œí‚¤ëŠ” ê²ƒì…ë‹ˆë‹¤.
## ë¶€ë¡ A) ì„¤ì¹˜ ì½”ë“œ ì›ë¬¸ ë³µì›

ì•„ë˜ ì½”ë“œëŠ” ì´ì „ ë²„ì „ì—ì„œ ì œê±°ë˜ì—ˆë˜ ì„¤ì¹˜ ì½”ë“œ ë¸”ë¡ì„ **ì›ë¬¸ ê·¸ëŒ€ë¡œ** ë³µì›í•œ ë‚´ìš©ì…ë‹ˆë‹¤.

**ì œ 3ì¥. ìµœì¢… íŒŒì´ì¬ ì½”ë“œ (install\_manager.pyw)**

**ì„¤ì¹˜ ê´€ë¦¬ìì˜ ì˜ì¡´ì„±ì„ ì œê±°**í•˜ê³ , **í† í° ê¸°ë°˜ ììœ¨ êµ¬ë™ ë¡œì§**ì´ íƒ‘ì¬ëœ ìµœì¢… ì½”ë“œì…ë‹ˆë‹¤.

Python

"""  
\[System Header\]  
Project: PDF Indexer v42.1 Zero-Dependency Edition  
Description: Installer uses ONLY standard libraries. Runner has full features.  
Integrity: Solves 'No Response' issue by removing premature imports.

\================================================================================================  
\[SYSTEM CONSTITUTION: í”„ë¡œê·¸ë¨ êµ¬ì„± ì›ì¹™\]  
4\. êµ¬ì„±  
\* í”„ë¡œê·¸ë¨ êµ¬ì„±  
\- \*\*í”„ë¡œê·¸ë¨ ì½”ë“œì—ëŠ” '4. êµ¬ì„±'ì˜ ëª¨ë“  ë‚´ìš©ì´ ì½”ë“œ ìµœìƒë‹¨ì— ì „ì²´ ë‚´ìš© ê¸°ì… \+ ê´€ë ¨ ì½”ë“œ í•­ëª©ì— ê°ê° ì½”ë©˜íŠ¸ ê¸°ì… í•„ìš” : ìµœì¢… : ìµœìƒë‹¨ì— êµ¬ì„± ì „ì²´ ë‚´ìš© ê¸°ì… \+ ê° í•­ëª©ë³„ ì½”ë©˜íŠ¸ ê¸°ì… (ë‹¤ë¥¸ ai í˜¹ì€ í”„ë¡œê·¸ë˜ë¨¸ê°€ ì½”ë“œë§Œ ë³´ê³  ì½”ë“œ ì‘ì„± ê°€ì´ë“œë¥¼ ë”°ë¥¼ ìˆ˜ ìˆì–´ì•¼ í•¨)\*\*  
\- \*\*ì‚¬ìš©ìëŠ” ì„¤ì¹˜ íŒŒì¼ë§Œ ì‹¤í–‰, ë‚˜ë¨¸ì§€ ì„¤ì¹˜ ê³¼ì •ì€ íŒŒì´ì¬ ì½”ë“œê°€ ìë™ìœ¼ë¡œ ì§„í–‰\*\*  
\- \*\*'ì„¤ì¹˜ GUI', 'ì‹¤í–‰ GUI' ë¡œ êµ¬ë¶„\*\*  
\- \*\*ëª¨ë“  ê³¼ì •ì€ GUI ë¥¼ ì ìš©í•˜ì—¬ .pyw ë¡œ cmd ì°½ ì—†ì´ GUIë¡œ ì§„í–‰\*\*  
\- \*\*'ì„¤ì¹˜ GUI' íŒŒì¼ì„ ì‹¤í–‰í•˜ë©´, \[í´ë” ìƒì„± \-\> íŒŒì¼ ìƒì„± \-\> í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ ìë™ ë‹¤ìš´ë¡œë“œ ë° ì„¤ì¹˜\] ê¹Œì§€ ì›í´ë¦­ ì§„í–‰\*\*  
\- \*\*ì„¤ì¹˜ê°€ ì™„ë£Œ í›„, ì„¤ì¹˜ëœ 'ì‹¤í–‰ GUI' íŒŒì¼ë¡œ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰\*\*  
\- \*\*ì†ŒìŠ¤ ì½”ë“œëŠ” ë°˜ë“œì‹œ ì˜ì–´(English)ë¡œ ì‘ì„±í•˜ì—¬ ì½”ë“œ í˜¸í™˜ì„± ìœ ì§€\*\*  
\- \*\*GUI ì¶œë ¥(ë¼ë²¨, ë²„íŠ¼, ì•Œë¦¼ì°½)ì€ ë°˜ë“œì‹œ í•œêµ­ì–´(Korean)ë¡œ ì‘ì„±í•˜ì—¬ ì‚¬ìš©ì í¸ì˜ì„± ê·¹ëŒ€í™”\*\*  
\- \*\*ì—­í• , íŒŒíŠ¸ ë³„ë¡œ íŒŒì¼ì„ ë‚˜ëˆ„ì–´ì„œ 1ê°œì˜ í´ë” ì•ˆì— ì €ì¥\*\*

\* 'ì„¤ì¹˜ GUI'  
\- \*\*ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì„¤ì¹˜ë˜ëŠ” ê³¼ì •ì„ ê²€ì€ìƒ‰ CMD ì°½ì´ ì•„ë‹Œ, 'ì„¤ì¹˜ GUI' ë¡œë”© ì°½(Progress Bar)ìœ¼ë¡œ í‘œí˜„\*\*  
\- \*\*ëª¨ë“  ì„¤ì¹˜ ê³¼ì •ì€ í•­ëª© ë³„ë¡œ ì´ ì‘ì—…ëŸ‰ ëŒ€ë¹„ í˜„ì¬ ì‘ì—…ëŸ‰ì„ í¼ì„¼í‹°ì§€í™” í•˜ì—¬ ì§„ì²™ë¥ ì„ í™•ì¸í•  ìˆ˜ ìˆëŠ” ì‹œê°ì  ì´ë¯¸ì§€ ì ìš©\*\*  
\- \*\*ì„¤ì¹˜ ì§„í–‰ë¥ ì€ ì „ì²´ í•­ëª©ê³¼ í˜„ì¬ í•­ëª©ì„ êµ¬ë¶„í•˜ì—¬ Progress Bar ë¥¼ ê°ê° ì ìš©\*\*  
\- \*\*ì„¤ì¹˜ í´ë”ë¥¼ 'ì„¤ì¹˜ GUI' ì•ˆì˜ ë²„íŠ¼ì„ ì´ìš©í•˜ì—¬ ì‚¬ìš©ìê°€ ì§€ì •\*\*  
\- \*\*ê²°ê³¼ íŒŒì¼ì€ ì§€ì • ëœ ì„¤ì¹˜ í´ë”ì— í•˜ìœ„í´ë” ì—†ì´ ì €ì¥\*\*

\* ì‹¤í–‰ GUI  
\- \*\*PDF ë³€í™˜ì´ ì§„í–‰ë˜ëŠ” ê³¼ì •ì„ ê²€ì€ìƒ‰ CMD ì°½ì´ ì•„ë‹Œ, 'ì‹¤í–‰ GUI' ë¡œë”© ì°½(Progress Bar)ìœ¼ë¡œ í‘œí˜„\*\*  
\- \*\*PDF íŒŒì¼ ì—…ë¡œë“œëŠ” 'ì‹¤í–‰ GUI' ì•ˆì˜ ë²„íŠ¼ì„ ì´ìš©í•˜ì—¬ ì‚¬ìš©ìê°€ ì ìš©\*\*  
\- \*\*ì‘ì—… ê³¼ì •ì€ í•­ëª© ë³„ë¡œ ì´ ì‘ì—…ëŸ‰ ëŒ€ë¹„ í˜„ì¬ ì‘ì—…ëŸ‰ì„ í¼ì„¼í‹°ì§€í™” í•˜ì—¬ ì§„ì²™ë¥ ì„ í™•ì¸í•  ìˆ˜ ìˆëŠ” ì‹œê°ì  ì´ë¯¸ì§€ ì ìš©\*\*  
\- \*\*ì‘ì—… ì§„í–‰ë¥ ì€ ì „ì²´ í•­ëª©ê³¼ í˜„ì¬ í•­ëª©ì„ êµ¬ë¶„í•˜ì—¬ Progress Bar ë¥¼ ê°ê° ì ìš©\*\*  
\- \*\*ì›ë³¸ íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ” í´ë”ë¥¼ 'ì‹¤í–‰ GUI' ìƒì—ì„œ ì‚¬ìš©ìê°€ ì§€ì •\*\*  
\- \*\*í”„ë¡œê·¸ë¨ì„ ì œì‘í•˜ëŠ” ê³¼ì •ì—ì„œ ëˆ„ì ëœ íŒ¨ì¹˜ ë° ì—…ë°ì´íŠ¸ ì‚¬í•­ì— ëŒ€í•œ ëª¨ë“  ë‚´ìš©ì„ ëˆ„ë½ì—†ì´ í‘œì‹œ (ì‹œìŠ¤í…œ ê°œë°œ ì—­ì‚¬ í˜ì´ì§€ëŠ” ë²„ì „ë³„ë¡œ í´ë”í˜•ì‹ìœ¼ë¡œ ëˆŒëŸ¬ì„œ ì—´ì–´ë³¼ ìˆ˜ ìˆë˜ë¡ ëˆ„ë½ì—†ì´ ëª¨ë“  ë‚´ìš© ê¸°ì…,í•µì‹¬ ìš”ì•½ì´ ì•„ë‹ˆë¼ ê´€ë ¨ ë‚´ìš©ì´ ìì„¸í•˜ê²Œ ê¸°ì…\*\*  
\================================================================================================  
"""  
\# \[IMPORTANT\] Installer Imports MUST remain standard library only  
import sys  
import ctypes  
import os  
import subprocess  
import threading  
import tkinter as tk  
from tkinter import ttk, filedialog, messagebox  
import time

\# \=================================================================================  
\# \[PART 1\] ì‹¤í–‰ GUI ì†ŒìŠ¤ì½”ë“œ (RUNNER\_SOURCE)  
\# This string contains the full application code which WILL use external libraries.  
\# \=================================================================================  
RUNNER\_SOURCE \= r'''  
import os  
import sys  
import time  
import re  
import threading  
import traceback  
import logging  
import gc   
import hashlib  
import csv  
import shutil  
import json  
import tkinter as tk  
import ctypes   
import psutil  
from logging.handlers import RotatingFileHandler  
from tkinter import ttk, filedialog, messagebox, scrolledtext  
from datetime import datetime, timedelta  
from concurrent.futures import ThreadPoolExecutor

\# Windows Power Management Constants  
ES\_CONTINUOUS \= 0x80000000  
ES\_SYSTEM\_REQUIRED \= 0x00000001

\# \- \*\*í”„ë¡œê·¸ë¨ì„ ì œì‘í•˜ëŠ” ê³¼ì •ì—ì„œ ëˆ„ì ëœ íŒ¨ì¹˜ ë° ì—…ë°ì´íŠ¸ ì‚¬í•­ì— ëŒ€í•œ ëª¨ë“  ë‚´ìš©ì„ ëˆ„ë½ì—†ì´ í‘œì‹œ\*\*  
HISTORY\_TEXT \= """  
\[v42.1\] ì œë¡œ ë””íœë˜ì‹œ  
 \- ì„¤ì¹˜ í”„ë¡œê·¸ë¨ ë¬´ë°˜ì‘ í•´ê²°: ì„¤ì¹˜ íŒŒì¼ì˜ ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì˜ì¡´ì„± ì œê±°.

\[v42.0\] ë¶ˆì‚¬ì¡°(Phoenix)  
 \- í† í° ê¸°ë°˜ ë³µêµ¬ ì‹œìŠ¤í…œ ë„ì…: 'recovery.token' íŒŒì¼ì„ ì´ìš©í•´ ì •ìƒ ì‹¤í–‰ê³¼ ì¬ë‚œ ë³µêµ¬ë¥¼ êµ¬ë¶„.  
 \- ìŠ¤ë§ˆíŠ¸ ì¬ì‹œì‘: ì‚¬ìš©ìê°€ ì§ì ‘ ì¼  ê²½ìš° ëŒ€ê¸°, ì‘ì—… ì¤‘ íŠ•ê¸´ ê²½ìš°ì—ë§Œ ìë™ ì‹œì‘.

\[v41.1\] ììœ¨ êµ¬ë™  
 \- ìë™ ì‘ì—… ì¬ê°œ: ì¬ì‹œì‘ ì˜µì…˜ í™œì„±í™” ì‹œ ìë™ ì‘ì—… ìˆ˜í–‰.  
 \- ì™„ë£Œ ì‹œ ìë™ OFF: ì „ì²´ ì‘ì—… ì™„ë£Œ í›„ ì¬ì‹œì‘ ì˜µì…˜ ìë™ í•´ì œ.

\[v41.0\] ì ˆëŒ€ ì£¼ê¶Œ  
 \- ìë™ ì¬ì‹œì‘(ì¢€ë¹„ ëª¨ë“œ) ON/OFF ìŠ¤ìœ„ì¹˜ íƒ‘ì¬.

\[v40.5\] ìµœì¢… ì„¤ê³„ì  
 \- ìŠ¤ë§ˆíŠ¸ ì¢…ë£Œ ë¡œì§ ì ìš©: ì‚¬ìš©ìê°€ ë„ë©´ êº¼ì§€ê³ , ì˜¤ë¥˜ë¡œ ì£½ìœ¼ë©´ ë˜ì‚´ì•„ë‚¨.  
 \- íˆìŠ¤í† ë¦¬ ë·°ì–´ ê°œì„ : ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•œ í…ìŠ¤íŠ¸ ë°•ìŠ¤ë¡œ ë³€ê²½í•˜ì—¬ ê°€ë…ì„± í™•ë³´.

\[v40.4\] ì™„ë²½ ìˆ˜ì •  
 \- êµ¬ë™ë¶€ ë²„ê·¸ í”½ìŠ¤: ì‹¤í–‰ í”„ë¡œê·¸ë¨ ë‚´ë¶€ í´ë˜ìŠ¤ í˜¸ì¶œ ì˜¤ë¥˜ ìˆ˜ì •.

\[v40.3\] ì¹¨ë¬µì˜ ë§ˆìŠ¤í„°  
 \- ë¬´ì¤‘ë‹¨ íˆë“  ëª¨ë“œ: ì‹¤í–‰ ì‹œ CMD ê²€ì€ ì°½ì´ ëœ¨ì§€ ì•Šë„ë¡ VBScript ëŸ°ì²˜ ì ìš©.  
 \- êµ¬ì„± ì›ì¹™ í†µí•©: ì†ŒìŠ¤ ì½”ë“œ ìµœìƒë‹¨ì— ê°œë°œ ê°€ì´ë“œë¼ì¸ ëª…ì‹œ.

\[v40.2\] ì•ˆì •ì„± ê°•í™”  
 \- ì—”ì§„ ì£¼ê¸°ì  ì¬ì¥ì „: 50ê°œ íŒŒì¼ ì²˜ë¦¬ ì‹œë§ˆë‹¤ AI ì—”ì§„ ë¦¬ë¡œë“œ(Reload)ë¡œ VRAM ëˆ„ìˆ˜ ì°¨ë‹¨.

\[v40.1\] ì½”ë“œ ê·œì•½  
 \- êµ¬ì„± ì›ì¹™ ëª…ì‹œ: í–¥í›„ ìœ ì§€ë³´ìˆ˜ë¥¼ ìœ„í•´ ì½”ë“œ ë‚´ ê°€ì´ë“œ ì£¼ì„ ì™„ë¹„.

\[v39.1\] ì™„ì „ ê±´ë„ˆë›°ê¸°  
 \- ìŠ¤í‚µ ë¡œì§ ê³ ë„í™”: ì„±ê³µí•œ íŒŒì¼ \+ ê²©ë¦¬ëœ(Quarantined) íŒŒì¼ ëª¨ë‘ ê²€ì‚¬í•˜ì—¬ ê±´ë„ˆëœ€.

\[v39.0\] ê¸°ì–µì˜ ê¶ì „  
 \- ì„¤ì • ì˜ì†ì„±: í´ë” ê²½ë¡œ ë° ì˜µì…˜ê°’ ìë™ ì €ì¥/ë³µì› (JSON).

\[v38.1\] ë¬´í•œ ë£¨í”„  
 \- ìƒì¡´ì„± ê·¹ëŒ€í™”: í¬ë˜ì‹œ ë°œìƒ ì‹œ 5ì´ˆ í›„ ìë™ ë¶€í™œ.  
 \- ë©”ëª¨ë¦¬ ê°ì‹œ: RAM 90% ì´ˆê³¼ ì‹œ ì„ ì œì  ì•ˆì „ ì¬ì‹œì‘.

\[v38.0\] ë¬¸ì„œí™”  
 \- ì½”ë“œ ë ˆë²¨ êµ¬ì„± ê°€ì´ë“œ ì£¼ì„ íƒ‘ì¬.

\[v37.0\] ë©€í‹° ì½”ì–´  
 \- ê³ ì† ë³‘ë ¬ ì²˜ë¦¬(2-Threads) ì˜µì…˜ íƒ‘ì¬.

\[v36.0\] ê³ ë°€ë„ ìŠ¤ìº”  
 \- ê³ ë°€ë„ ìŠ¤ìº”(Scale 3.0) ì ìš© & ì„¤ì¹˜ ì—ëŸ¬ ìë™ ìš°íšŒ.

\[v35.2\] ê°•ì œ ì •ì°°  
 \- ê°•ì œ OCR ì˜µì…˜ ì¶”ê°€ (í…ìŠ¤íŠ¸ ë ˆì´ì–´ ë¬´ì‹œí•˜ê³  ì´ë¯¸ì§€ë¡œ íŒë…).

\[v35.1\] ê¸´ê¸‰ ìˆ˜ì •  
 \- ì—”ì§„ ë¡œë”© ë³€ìˆ˜ëª… ì˜¤ë¥˜ ìˆ˜ì •.

\[v35.0\] í†µì œê¶Œ  
 \- ì‘ì—… ì¤‘ë‹¨(Stop) ë²„íŠ¼ ë³µêµ¬.

\[v34.5\] ì •ë°€ íƒ€ê²©  
 \- ìŠ¤ë§ˆíŠ¸ ìŠ¤í‚µ ì ìš© (ì´ë¯¸ ìˆëŠ” íŒŒì¼ ë¡œë”© ì—†ì´ ê±´ë„ˆëœ€).

\[v34.1\] ê¶ê·¹ì˜ GUI  
 \- CMD ì œê±° & ë“€ì–¼ í”„ë¡œê·¸ë˜ìŠ¤ ë°” ë„ì….

\[v33.0\] ì•ˆì „ ë˜í¼  
 \- ì‹¤í–‰ ë¬´ë°˜ì‘ í•´ê²°ì„ ìœ„í•œ ìê°€ ì§„ë‹¨ ë˜í¼.

\[v31.3\] ì´ë¦„ ì •ë¦¬  
 \- íŒŒì¼ëª… í•´ì‹œ ì œê±°, ì›ë³¸ íŒŒì¼ëª… ìœ ì§€.

\[v31.0\] í…ìŠ¤íŠ¸ ì½”ì–´  
 \- ì´ë¯¸ì§€ ì €ì¥ ì œê±°ë¡œ ì†ë„ 500% í–¥ìƒ.

\[v30.0\] ê²©ë¦¬ êµ¬ì—­  
 \- ë…ë¦½ ê°€ìƒí™˜ê²½(VENV) êµ¬ì¶•.

\[v24.0\] ìë™ ë°©ì—­  
 \- ë¶ˆëŸ‰ ë°ì´í„° ìë™ ê²©ë¦¬.

\[v10.0\] CUDA ì—”ì§„  
 \- NVIDIA GPU ê°€ì† ì—”ì§„ íƒ‘ì¬.  
"""

class IORedirector(object):  
    def \_\_init\_\_(self, text\_widget, root):  
        self.text\_widget \= text\_widget  
        self.root \= root  
    def write(self, str\_msg):  
        self.root.after(0, lambda: self.append\_text(str\_msg))  
    def flush(self): pass  
    def append\_text(self, str\_msg):  
        try:  
            self.text\_widget.config(state="normal")  
            if int(self.text\_widget.index("end-1c").split(".")\[0\]) \> 3000:  
                self.text\_widget.delete("1.0", "500.0")  
                str\_msg \= "\\n\[Logs Cleaned\]\\n" \+ str\_msg  
            self.text\_widget.insert("end", str\_msg)  
            self.text\_widget.see("end")  
            self.text\_widget.config(state="disabled")  
        except: pass

class PDFIndexerApp:  
    def \_\_init\_\_(self, root):  
        self.root \= root  
        self.root.title("ê¸°êµ¬ ì„¤ê³„ PDF ë°ì´í„° êµ¬ì¶•ê¸° (v42.1 Zero-Dependency)")  
        self.root.geometry("1400x950")  
          
        self.root.protocol("WM\_DELETE\_WINDOW", self.on\_closing)  
          
        self.input\_dir \= tk.StringVar()  
        self.output\_dir \= tk.StringVar()  
          
        \# Options  
        self.var\_keep\_hanja \= tk.BooleanVar(value=False)  
        self.var\_force\_ocr \= tk.BooleanVar(value=False)  
        self.var\_parallel \= tk.BooleanVar(value=False)  
        self.var\_auto\_restart \= tk.BooleanVar(value=True)   
          
        self.is\_running \= False  
        self.stop\_event \= threading.Event()  
        self.converter \= None  
        self.logger \= logging.getLogger("BlackBox")  
        self.logger.setLevel(logging.INFO)  
          
        self.processed\_count \= 0  
        self.total\_files \= 0  
        self.config\_file \= "indexer\_config.json"  
          
        \# \[v42.0\] Token File  
        self.token\_file \= "recovery.token"  
          
        self.setup\_ui()  
        self.load\_config()   
        self.update\_restart\_flag()  
        sys.stdout \= IORedirector(self.txt\_log, self.root)  
        sys.stderr \= IORedirector(self.txt\_log, self.root)

        \# \[v42.0\] Token Check  
        if self.var\_auto\_restart.get() and os.path.exists(self.token\_file):  
            if self.input\_dir.get() and self.output\_dir.get():  
                self.log\_gui("ğŸ”¥ ë¹„ì •ìƒ ì¢…ë£Œ(Crash) ê°ì§€ë¨. 3ì´ˆ í›„ ìë™ ë³µêµ¬ ì‹œì‘...")  
                self.root.after(3000, self.auto\_start\_trigger)  
            else:  
                self.cleanup\_token()  
        else:  
            self.cleanup\_token()

    def auto\_start\_trigger(self):  
        if not self.is\_running:  
            self.toggle\_processing()

    def create\_token(self):  
        try:  
            with open(self.token\_file, "w") as f: f.write("active")  
        except: pass

    def cleanup\_token(self):  
        try:  
            if os.path.exists(self.token\_file):  
                os.remove(self.token\_file)  
        except: pass

    def on\_closing(self):  
        if self.is\_running:  
            if not messagebox.askyesno("ì¢…ë£Œ", "ì‘ì—…ì´ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤. ì •ë§ ì¢…ë£Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"):  
                return  
        self.cleanup\_token() \# Clean exit  
        self.root.destroy()  
        sys.exit(0) 

    def log\_gui(self, message):  
        timestamp \= datetime.now().strftime('%H:%M:%S')  
        full\_msg \= f"\[{timestamp}\] {message}"  
        print(full\_msg)   
        if hasattr(self, 'logger'):  
            try: self.logger.info(message)  
            except: pass

    def load\_config(self):  
        try:  
            if os.path.exists(self.config\_file):  
                with open(self.config\_file, 'r', encoding='utf-8') as f:  
                    data \= json.load(f)  
                    self.input\_dir.set(data.get("input\_dir", ""))  
                    self.output\_dir.set(data.get("output\_dir", ""))  
                    self.var\_keep\_hanja.set(data.get("keep\_hanja", False))  
                    self.var\_force\_ocr.set(data.get("force\_ocr", False))  
                    self.var\_parallel.set(data.get("parallel", False))  
                    self.var\_auto\_restart.set(data.get("auto\_restart", True))   
                self.log\_gui("ğŸ“‚ ì´ì „ ì„¤ì •ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.")  
        except Exception as e:  
            self.log\_gui(f"âš ï¸ ì„¤ì • ë¡œë“œ ì‹¤íŒ¨: {e}")

    def save\_config(self):  
        try:  
            data \= {  
                "input\_dir": self.input\_dir.get(),  
                "output\_dir": self.output\_dir.get(),  
                "keep\_hanja": self.var\_keep\_hanja.get(),  
                "force\_ocr": self.var\_force\_ocr.get(),  
                "parallel": self.var\_parallel.get(),  
                "auto\_restart": self.var\_auto\_restart.get()  
            }  
            with open(self.config\_file, 'w', encoding='utf-8') as f:  
                json.dump(data, f, indent=4, ensure\_ascii=False)  
        except Exception as e:  
            self.log\_gui(f"âš ï¸ ì„¤ì • ì €ì¥ ì‹¤íŒ¨: {e}")

    def update\_restart\_flag(self):  
        \# We handle restart logic via Token now, but keeping flag file for BAT just in case  
        pass

    def setup\_ui(self):  
        paned \= tk.PanedWindow(self.root, orient=tk.HORIZONTAL, sashwidth=5, bg="\#bdc3c7")  
        paned.pack(fill=tk.BOTH, expand=True)  
          
        left \= tk.Frame(paned, bg="\#fdfefe", padx=20, pady=20)  
        paned.add(left, minsize=600)  
          
        header \= tk.Frame(left, bg="\#fdfefe")  
        header.pack(fill="x", pady=(0, 20))  
        tk.Label(header, text="PDF ë³€í™˜ ì»¨íŠ¸ë¡¤ëŸ¬", font=("Malgun Gothic", 20, "bold"), bg="\#fdfefe", fg="\#2c3e50").pack(side="left")  
        self.lbl\_gpu \= tk.Label(header, text="GPU: í™•ì¸ ì¤‘...", font=("Malgun Gothic", 10, "bold"), bg="\#ecf0f1", fg="\#7f8c8d", padx=10, pady=5, relief="ridge")  
        self.lbl\_gpu.pack(side="right")  
          
        tk.Label(left, text="1. ì›ë³¸ PDF í´ë”:", font=("Malgun Gothic", 10, "bold"), bg="\#fdfefe").pack(anchor="w")  
        f1 \= tk.Frame(left, bg="\#fdfefe")  
        f1.pack(fill="x", pady=5)  
        tk.Entry(f1, textvariable=self.input\_dir, state="readonly", bg="white").pack(side="left", fill="x", expand=True, ipady=3)  
        tk.Button(f1, text="í´ë” ì°¾ê¸°", command=lambda: self.input\_dir.set(filedialog.askdirectory()), bg="\#ecf0f1").pack(side="right")  
          
        tk.Label(left, text="2. ë°ì´í„° ì €ì¥ í´ë”:", font=("Malgun Gothic", 10, "bold"), bg="\#fdfefe").pack(anchor="w")  
        f2 \= tk.Frame(left, bg="\#fdfefe")  
        f2.pack(fill="x", pady=5)  
        tk.Entry(f2, textvariable=self.output\_dir, state="readonly", bg="white").pack(side="left", fill="x", expand=True, ipady=3)  
        tk.Button(f2, text="í´ë” ì°¾ê¸°", command=lambda: self.output\_dir.set(filedialog.askdirectory()), bg="\#ecf0f1").pack(side="right")  
          
        opt \= tk.LabelFrame(left, text="ì„¤ì • (Settings)", bg="\#fdfefe", padx=10, pady=5)  
        opt.pack(fill="x", pady=10)  
        tk.Checkbutton(opt, text="ì¼ë³¸ì–´/í•œì ìœ ì§€", variable=self.var\_keep\_hanja, bg="\#fdfefe", font=("Malgun Gothic", 9)).pack(anchor="w")  
        tk.Checkbutton(opt, text="ê³ ë°€ë„ ì •ë°€ ë¶„ì„ (ê°•ì œ OCR) \- í’ˆì§ˆâ†‘ ì†ë„â†“", variable=self.var\_force\_ocr, bg="\#fdfefe", fg="\#c0392b", font=("Malgun Gothic", 9, "bold")).pack(anchor="w")  
        tk.Checkbutton(opt, text="ê³ ì† ë³‘ë ¬ ì²˜ë¦¬ (2-Threads) \- ì†ë„â†‘ ë©”ëª¨ë¦¬â†‘", variable=self.var\_parallel, bg="\#fdfefe", fg="\#2980b9", font=("Malgun Gothic", 9, "bold")).pack(anchor="w")  
          
        tk.Checkbutton(opt, text="ì˜¤ë¥˜ ë°œìƒ ì‹œ ìë™ ì¬ì‹œì‘ (Auto-Recovery)", variable=self.var\_auto\_restart, bg="\#fdfefe", fg="\#e67e22", font=("Malgun Gothic", 9, "bold")).pack(anchor="w")  
          
        st \= tk.LabelFrame(left, text="ì‘ì—… ëŒ€ì‹œë³´ë“œ", bg="\#fdfefe", padx=10, pady=5)  
        st.pack(fill="x", pady=10)  
          
        tk.Label(st, text="ì „ì²´ ì§„í–‰ë¥  (Total)", font=("Malgun Gothic", 9), bg="\#fdfefe").pack(anchor="w")  
        self.pb\_total \= ttk.Progressbar(st, orient="horizontal", length=100, mode="determinate")  
        self.pb\_total.pack(fill="x", pady=(0, 5))  
          
        tk.Label(st, text="í˜„ì¬ íŒŒì¼ (Current Batch)", font=("Malgun Gothic", 9), bg="\#fdfefe").pack(anchor="w")  
        self.pb\_current \= ttk.Progressbar(st, orient="horizontal", length=100, mode="determinate")  
        self.pb\_current.pack(fill="x", pady=(0, 5))

        self.lbl\_main\_status \= tk.Label(st, text="ëŒ€ê¸° ì¤‘...", font=("Malgun Gothic", 11, "bold"), fg="\#2c3e50", bg="\#fdfefe", anchor="w")  
        self.lbl\_main\_status.pack(fill="x", pady=5)  
        self.lbl\_detail\_status \= tk.Label(st, text="-", font=("Malgun Gothic", 9), fg="\#7f8c8d", bg="\#fdfefe", anchor="w")  
        self.lbl\_detail\_status.pack(fill="x")  
          
        tk.Label(left, text="ì‹¤ì‹œê°„ ë¡œê·¸:", font=("Malgun Gothic", 9, "bold"), bg="\#fdfefe").pack(anchor="w")  
        self.txt\_log \= tk.Text(left, height=12, state="disabled", font=("Consolas", 9), bg="\#f4f6f7")  
        self.txt\_log.pack(fill="both", expand=True, pady=5)  
          
        self.btn\_start \= tk.Button(left, text="ë³€í™˜ ì‹œì‘ (Start)", command=self.toggle\_processing, bg="\#27ae60", fg="white", font=("Malgun Gothic", 14, "bold"), height=2)  
        self.btn\_start.pack(fill="x", pady=10)  
          
        right \= tk.Frame(paned, bg="\#ecf0f1", padx=15, pady=15)  
        paned.add(right, minsize=450)  
          
        tk.Label(right, text="ğŸ“˜ ì‹œìŠ¤í…œ ê°œë°œ ì—­ì‚¬ (History)", font=("Malgun Gothic", 14, "bold"), bg="\#ecf0f1", fg="\#27ae60").pack(anchor="w", pady=(0, 10))  
          
        self.txt\_history \= scrolledtext.ScrolledText(right, font=("Malgun Gothic", 9), bg="white", relief="flat")  
        self.txt\_history.pack(fill="both", expand=True, pady=(0, 10))  
        self.txt\_history.insert("end", HISTORY\_TEXT)  
        self.txt\_history.config(state="disabled")

        tk.Label(right, text="âŒ ê²©ë¦¬/ì‹¤íŒ¨ ëª©ë¡", font=("Malgun Gothic", 12, "bold"), bg="\#ecf0f1", fg="\#c62828").pack(anchor="w", pady=(10, 5))  
        self.lst\_errors \= tk.Listbox(right, font=("Consolas", 9), bg="white", fg="\#c62828")  
        self.lst\_errors.pack(fill="both", expand=True)

    def add\_error\_log(self, filename, reason):  
        msg \= f"\[{datetime.now().strftime('%H:%M')}\] {filename} : {reason}"  
        self.root.after(0, lambda: self.lst\_errors.insert("end", msg))  
        self.root.after(0, lambda: self.lst\_errors.see("end"))

    def prevent\_sleep(self):  
        try: ctypes.windll.kernel32.SetThreadExecutionState(ES\_CONTINUOUS | ES\_SYSTEM\_REQUIRED)  
        except: pass  
      
    def allow\_sleep(self):  
        try: ctypes.windll.kernel32.SetThreadExecutionState(ES\_CONTINUOUS)  
        except: pass

    def check\_memory(self):  
        mem \= psutil.virtual\_memory()  
        if mem.percent \> 90:  
            self.log\_gui(f"âš  ê²½ê³ : ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ {mem.percent}% ì´ˆê³¼. ì•ˆì „ì„ ìœ„í•´ ì¬ì‹œì‘ì„ ê¶Œì¥í•©ë‹ˆë‹¤.")  
            return False  
        return True

    def get\_path\_hash(self, full\_path):  
        return hashlib.sha256(full\_path.encode('utf-8', 'ignore')).hexdigest()\[:8\]

    def sanitize\_filename(self, filename):  
        name, ext \= os.path.splitext(filename)  
        safe \= re.sub(r'\[^\\w\\-\\.\]', '\_', name)  
        return safe \+ ext

    def clean\_text(self, text):  
        if not text: return ""  
        if not self.var\_keep\_hanja.get():  
            text \= re.sub(r'\[\\u4e00-\\u9fff\\u3040-\\u309f\\u30a0-\\u30ff\]', '', text)  
        return text.strip()

    def check\_capacity\_safe(self, input\_path, output\_path):  
        try:  
            total\_input \= 0  
            for r, d, f in os.walk(input\_path):  
                for file in f:  
                    if file.lower().endswith('.pdf'): total\_input \+= os.path.getsize(os.path.join(r, file))  
            total, used, free \= shutil.disk\_usage(output\_path)  
            req \= total\_input \* 1.2  
            if free \< req: return False, f"ìš©ëŸ‰ ë¶€ì¡±\! (í•„ìš”: {req/1024\*\*3:.2f}GB)"  
            return True, "OK"  
        except: return True, "Skip"

    def write\_atomic(self, file\_path, content):  
        temp\_path \= file\_path \+ ".tmp"  
        try:  
            with open(temp\_path, "w", encoding="utf-8") as f: f.write(content)  
            for i in range(3):  
                try:  
                    if os.path.exists(file\_path): os.remove(file\_path)  
                    os.rename(temp\_path, file\_path)  
                    return True  
                except OSError: time.sleep(0.5)  
            return True  
        except: return False

    def append\_manifest(self, filename, file\_hash, status, text\_len, note=""):  
        try:  
            csv\_path \= os.path.join(self.output\_dir.get(), "report\_manifest.csv")  
            is\_new \= not os.path.exists(csv\_path)  
            with open(csv\_path, "a", newline="", encoding="utf-8-sig") as f:  
                w \= csv.writer(f)  
                if is\_new: w.writerow(\["Timestamp", "Filename", "Hash", "Status", "Text\_Length", "Note"\])  
                w.writerow(\[datetime.now().strftime("%Y-%m-%d %H:%M:%S"), filename, file\_hash, status, text\_len, note\])  
        except: pass

    def toggle\_processing(self):  
        if self.is\_running:  
            if messagebox.askyesno("í™•ì¸", "ì‘ì—…ì„ ì¤‘ë‹¨í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"):  
                self.stop\_event.set()  
                self.cleanup\_token()   
                self.btn\_start.config(text="ì¤‘ë‹¨ ìš”ì²­ë¨...", state="disabled")  
            return

        if not self.input\_dir.get() or not self.output\_dir.get():  
            messagebox.showwarning("ê²½ê³ ", "í´ë”ë¥¼ ì„ íƒí•˜ì„¸ìš”.")  
            return  
          
        ok, msg \= self.check\_capacity\_safe(self.input\_dir.get(), self.output\_dir.get())  
        if not ok and not messagebox.askyesno("ê²½ê³ ", f"{msg}\\nì§„í–‰í•©ë‹ˆê¹Œ?"): return  
          
        self.save\_config()  
        self.create\_token()  
          
        self.is\_running \= True  
        self.btn\_start.config(state="normal", text="ì‘ì—… ì¤‘ë‹¨ (Stop)", bg="\#e74c3c")  
        self.stop\_event.clear()  
          
        try:  
            lf \= os.path.join(self.output\_dir.get(), "system\_debug.log")  
            fh \= RotatingFileHandler(lf, maxBytes=5\*1024\*1024, backupCount=5, encoding="utf-8")  
            fh.setFormatter(logging.Formatter('%(asctime)s \[%(levelname)s\] %(message)s'))  
            self.logger.handlers \= \[\]  
            self.logger.addHandler(fh)  
        except: pass

        t \= threading.Thread(target=self.process\_manager)  
        t.daemon \= True  
        t.start()

    def process\_manager(self):  
        self.prevent\_sleep()  
        logging.getLogger("docling").setLevel(logging.WARNING)  
          
        if self.converter is None:  
            self.log\_gui("ğŸš€ ì—”ì§„ ë¡œë”© ì‹œì‘... (ëª¨ë¸ ë‹¤ìš´ë¡œë“œ)")  
            self.root.after(0, lambda: self.pb\_current.configure(mode="indeterminate"))  
            self.root.after(0, lambda: self.pb\_current.start(10))  
            try:  
                import torch  
                if torch.cuda.is\_available():  
                    g \= torch.cuda.get\_device\_name(0)  
                    self.root.after(0, lambda: self.lbl\_gpu.config(text=f"ğŸŸ¢ GPU Active: {g}", fg="green"))  
                    self.log\_gui(f"â˜… GPU ê°€ì† í™œì„±í™”: {g}")  
                else:  
                    self.root.after(0, lambda: self.lbl\_gpu.config(text="ğŸ”´ CPU Mode", fg="red"))

                from docling.document\_converter import DocumentConverter, PdfFormatOption  
                from docling.datamodel.pipeline\_options import PdfPipelineOptions, TableFormerMode  
                from docling.datamodel.base\_models import InputFormat  
                  
                ops \= PdfPipelineOptions()  
                ops.do\_ocr \= True  
                ops.do\_table\_structure \= True  
                ops.table\_structure\_options.mode \= TableFormerMode.ACCURATE  
                ops.generate\_picture\_images \= False   
                  
                if self.var\_force\_ocr.get():  
                    self.log\_gui("âš ï¸ \[ê³ ë°€ë„ ìŠ¤ìº”\] í™œì„±í™”: Scale 3.0 ì ìš© (ì†ë„ ëŠë¦¼)")  
                    ops.images\_scale \= 3.0   
                  
                self.converter \= DocumentConverter(  
                    format\_options={InputFormat.PDF: PdfFormatOption(pipeline\_options=ops)}  
                )  
                self.log\_gui("âœ… ì—”ì§„ ì¤€ë¹„ ì™„ë£Œ.")  
            except Exception as e:  
                self.log\_gui(f"âŒ ì—”ì§„ ì—ëŸ¬: {e}")  
                self.is\_running \= False  
                self.cleanup\_token()  
                self.root.after(0, self.reset\_ui)  
                self.allow\_sleep()  
                return  
            finally:  
                self.root.after(0, lambda: self.pb\_current.stop())  
                self.root.after(0, lambda: self.pb\_current.configure(mode="determinate"))

        pdf\_files \= \[\]  
        for r, d, f in os.walk(self.input\_dir.get()):  
            for file in f:  
                if file.lower().endswith(".pdf"): pdf\_files.append(os.path.join(r, file))  
          
        self.total\_files \= len(pdf\_files)  
        self.processed\_count \= 0  
        self.log\_gui(f"ì´ {self.total\_files}ê°œ íŒŒì¼ ë°œê²¬.")  
          
        q\_dir \= os.path.join(self.output\_dir.get(), "\_QUARANTINE\_LOW\_QUALITY")  
        os.makedirs(q\_dir, exist\_ok=True)  
        self.start\_t \= time.time()

        if self.var\_parallel.get():  
            self.log\_gui("âš¡ ê³ ì† ë³‘ë ¬ ì²˜ë¦¬(2-Threads) ëª¨ë“œë¡œ ì‹œì‘í•©ë‹ˆë‹¤.")  
            with ThreadPoolExecutor(max\_workers=2) as executor:  
                futures \= \[\]  
                for i, full\_path in enumerate(pdf\_files):  
                    if self.stop\_event.is\_set(): break  
                    if i \> 0 and i % 50 \== 0:  
                        self.log\_gui("â™»ï¸ ë³‘ë ¬ ì²˜ë¦¬ ì¤‘ ì—”ì§„ ìµœì í™” ëŒ€ê¸°...")  
                        time.sleep(2)   
                    futures.append(executor.submit(self.process\_single\_file, full\_path, q\_dir))  
                  
                for f in futures:  
                    if self.stop\_event.is\_set(): break  
                    try: f.result()  
                    except: pass  
        else:  
            self.log\_gui("ğŸ¢ ì¼ë°˜ ì²˜ë¦¬(1-Thread) ëª¨ë“œë¡œ ì‹œì‘í•©ë‹ˆë‹¤.")  
            for i, full\_path in enumerate(pdf\_files):  
                if self.stop\_event.is\_set(): break  
                if i \> 0 and i % 50 \== 0:  
                    self.log\_gui("â™»ï¸ ì—”ì§„ ë¦¬ë¡œë“œ (VRAM ì´ˆê¸°í™”)...")  
                    self.converter \= None  
                    gc.collect()  
                    try:  
                        import torch  
                        torch.cuda.empty\_cache()  
                    except: pass  
                    self.load\_converter()  
                self.process\_single\_file(full\_path, q\_dir)

        if not self.stop\_event.is\_set():  
            self.log\_gui("ğŸ‰ ëª¨ë“  ì‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ìë™ ì¬ì‹œì‘ ê¸°ëŠ¥ì„ í•´ì œí•©ë‹ˆë‹¤.")  
            self.var\_auto\_restart.set(False)   
            self.save\_config()  
            self.cleanup\_token()   
            messagebox.showinfo("ì™„ë£Œ", "ëª¨ë“  ì‘ì—…ì´ ëë‚¬ìŠµë‹ˆë‹¤.")  
        else:  
            self.log\_gui("â›” ì‘ì—…ì´ ì‚¬ìš©ìì— ì˜í•´ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤.")  
            self.cleanup\_token()   
            messagebox.showinfo("ì¤‘ë‹¨", "ì‘ì—…ì´ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤.")  
          
        self.allow\_sleep()  
        self.root.after(0, self.reset\_ui)

    def load\_converter(self):  
        try:  
            from docling.document\_converter import DocumentConverter, PdfFormatOption  
            from docling.datamodel.pipeline\_options import PdfPipelineOptions, TableFormerMode  
            from docling.datamodel.base\_models import InputFormat  
            ops \= PdfPipelineOptions()  
            ops.do\_ocr \= True  
            ops.do\_table\_structure \= True  
            ops.table\_structure\_options.mode \= TableFormerMode.ACCURATE  
            ops.generate\_picture\_images \= False   
            if self.var\_force\_ocr.get():  
                ops.images\_scale \= 3.0   
            self.converter \= DocumentConverter(  
                format\_options={InputFormat.PDF: PdfFormatOption(pipeline\_options=ops)}  
            )  
            return True  
        except: return False

    def process\_single\_file(self, full\_path, q\_dir):  
        if self.stop\_event.is\_set(): return  
        if not self.check\_memory(): pass 

        fname \= os.path.basename(full\_path)  
        phash \= self.get\_path\_hash(full\_path)  
        clean\_name \= self.sanitize\_filename(os.path.splitext(fname)\[0\])  
        md\_path \= os.path.join(self.output\_dir.get(), f"{clean\_name}.md")  
        q\_path \= os.path.join(q\_dir, f"{clean\_name}.md") 

        exists\_main \= os.path.exists(md\_path) and os.path.getsize(md\_path) \> 0  
        exists\_q \= os.path.exists(q\_path) and os.path.getsize(q\_path) \> 0

        if exists\_main or exists\_q:  
            reason \= "ë³€í™˜ ì™„ë£Œ" if exists\_main else "ê²©ë¦¬ë¨"  
            self.log\_gui(f"\[íŒ¨ìŠ¤\] {fname} ({reason})")  
            self.update\_progress(fname, skipped=True)  
            return

        self.root.after(0, lambda: self.lbl\_detail\_status.config(text=f"ì²˜ë¦¬ ì¤‘: {fname}"))  
          
        try:  
            res \= self.converter.convert(full\_path)  
            doc \= res.document  
            content \= \[\]  
            for item, \_ in doc.iterate\_items():  
                if hasattr(item, "text") and item.text:  
                    text \= self.clean\_text(item.text)  
                    if text: content.append(text)  
                if hasattr(item, "export\_to\_markdown"):  
                    try:  
                        tbl \= item.export\_to\_markdown()  
                        if tbl and "|" in tbl: content.append(tbl)  
                    except: pass  
              
            final\_text \= "\\n\\n".join(content)  
            tlen \= len(final\_text)  
            fsize \= os.path.getsize(full\_path) / (1024\*1024)  
              
            target\_file \= md\_path  
            if (fsize \> 5 and tlen \< 200\) or (tlen \< 50):  
                target\_file \= os.path.join(q\_dir, f"{clean\_name}.md")  
                self.log\_gui(f"\[ê²©ë¦¬\] {fname} (Len:{tlen})")  
                self.add\_error\_log(fname, f"Quarantined (Len:{tlen})")  
                self.append\_manifest(fname, phash, "QUARANTINED", tlen, "Low Density")  
            else:  
                self.log\_gui(f"\[ì™„ë£Œ\] {fname}")  
                self.append\_manifest(fname, phash, "SUCCESS", tlen, "")

            self.write\_atomic(target\_file, final\_text)  
              
            import torch  
            if torch.cuda.is\_available(): torch.cuda.empty\_cache()  
              
        except Exception as e:  
            self.log\_gui(f"\[ì‹¤íŒ¨\] {fname}")  
            self.add\_error\_log(fname, str(e))  
            self.append\_manifest(fname, phash, "ERROR", 0, str(e))  
            if os.path.exists(md\_path \+ ".tmp"):  
                try: os.remove(md\_path \+ ".tmp")  
                except: pass  
          
        self.update\_progress(fname)

    def update\_progress(self, fname, skipped=False):  
        self.processed\_count \+= 1  
        pct \= (self.processed\_count / self.total\_files) \* 100  
        self.root.after(0, lambda: self.pb\_total.configure(value=pct))  
          
        elapsed \= time.time() \- self.start\_t  
        if self.processed\_count \> 0:  
            avg \= elapsed / self.processed\_count  
            rem \= int(avg \* (self.total\_files \- self.processed\_count))  
            eta \= str(timedelta(seconds=rem))  
            status\_txt \= f"ì²˜ë¦¬ ì¤‘ ({self.processed\_count}/{self.total\_files}): {fname} (ETA: {eta})"  
            if skipped: status\_txt \= f"ê±´ë„ˆëœ€ (Skipped): {fname} (ETA: {eta})"  
            self.root.after(0, lambda: self.lbl\_main\_status.config(text=status\_txt))

    def reset\_ui(self):  
        self.is\_running \= False  
        self.btn\_start.config(text="ë³€í™˜ ì‹œì‘ (Start)", state="normal", bg="\#27ae60")  
        self.lbl\_main\_status.config(text="ì‘ì—… ëŒ€ê¸° ì¤‘")  
        self.lbl\_detail\_status.config(text="-")  
        self.pb\_total.configure(value=0)  
        self.pb\_current.configure(value=0)

if \_\_name\_\_ \== "\_\_main\_\_":  
    try:  
        root \= tk.Tk()  
        app \= PDFIndexerApp(root)  
        root.mainloop()  
    except Exception as e:  
        ctypes.windll.user32.MessageBoxW(0, f"Error: {str(e)}", "Critical", 0x10)  
'''

\# \=================================================================================  
\# \[PART 2\] ì„¤ì¹˜ GUI (InstallerGUI)  
\# \- \*\*'ì„¤ì¹˜ GUI', 'ì‹¤í–‰ GUI' ë¡œ êµ¬ë¶„\*\*  
\# \=================================================================================  
class InstallerGUI:  
    def \_\_init\_\_(self, root):  
        self.root \= root  
        self.root.title("ì„¤ì¹˜ ë§¤ë‹ˆì € (v42.1 Zero-Dependency)")  
        self.root.geometry("600x500")  
        self.root.configure(bg="\#f5f6fa")  
          
        desktop \= os.path.join(os.path.join(os.environ\['USERPROFILE'\]), 'Desktop')   
        self.install\_dir \= tk.StringVar(value=os.path.join(desktop, "PDF\_Indexer\_v42"))  
          
        self.setup\_ui()

    def setup\_ui(self):  
        header \= tk.Frame(self.root, bg="\#2c3e50", pady=15)  
        header.pack(fill="x")  
        \# \- \*\*GUI ì¶œë ¥(ë¼ë²¨, ë²„íŠ¼, ì•Œë¦¼ì°½)ì€ ë°˜ë“œì‹œ í•œêµ­ì–´(Korean)ë¡œ ì‘ì„±í•˜ì—¬ ì‚¬ìš©ì í¸ì˜ì„± ê·¹ëŒ€í™”\*\*  
        tk.Label(header, text="ê¸°êµ¬ ì„¤ê³„ PDF êµ¬ì¶•ê¸° ì„¤ì¹˜", font=("Malgun Gothic", 18, "bold"), fg="white", bg="\#2c3e50").pack()  
          
        body \= tk.Frame(self.root, bg="\#f5f6fa", padx=30, pady=20)  
        body.pack(fill="both", expand=True)  
          
        \# \- \*\*ì„¤ì¹˜ í´ë”ë¥¼ 'ì„¤ì¹˜ GUI' ì•ˆì˜ ë²„íŠ¼ì„ ì´ìš©í•˜ì—¬ ì‚¬ìš©ìê°€ ì§€ì •\*\*  
        tk.Label(body, text="ì„¤ì¹˜ ê²½ë¡œ ì§€ì •:", font=("Malgun Gothic", 11, "bold"), bg="\#f5f6fa").pack(anchor="w")  
        f\_dir \= tk.Frame(body, bg="\#f5f6fa")  
        f\_dir.pack(fill="x", pady=(5, 20))  
        tk.Entry(f\_dir, textvariable=self.install\_dir, font=("Malgun Gothic", 10)).pack(side="left", fill="x", expand=True, ipady=5)  
        tk.Button(f\_dir, text="ë³€ê²½", command=self.change\_dir, bg="\#dcdde1", font=("Malgun Gothic", 10)).pack(side="right", padx=(10, 0))  
          
        \# \- \*\*ì„¤ì¹˜ ì§„í–‰ë¥ ì€ ì „ì²´ í•­ëª©ê³¼ í˜„ì¬ í•­ëª©ì„ êµ¬ë¶„í•˜ì—¬ Progress Bar ë¥¼ ê°ê° ì ìš©\*\*  
        \# \- \*\*ëª¨ë“  ì„¤ì¹˜ ê³¼ì •ì€ í•­ëª© ë³„ë¡œ ì´ ì‘ì—…ëŸ‰ ëŒ€ë¹„ í˜„ì¬ ì‘ì—…ëŸ‰ì„ í¼ì„¼í‹°ì§€í™” í•˜ì—¬ ì§„ì²™ë¥ ì„ í™•ì¸í•  ìˆ˜ ìˆëŠ” ì‹œê°ì  ì´ë¯¸ì§€ ì ìš©\*\*  
        tk.Label(body, text="ì „ì²´ ì„¤ì¹˜ ì§„í–‰ë¥ :", font=("Malgun Gothic", 10), bg="\#f5f6fa").pack(anchor="w")  
        self.pb\_total \= ttk.Progressbar(body, orient="horizontal", length=100, mode="determinate")  
        self.pb\_total.pack(fill="x", pady=(5, 15))  
          
        tk.Label(body, text="í˜„ì¬ í•­ëª© ì§„í–‰ë¥ :", font=("Malgun Gothic", 10), bg="\#f5f6fa").pack(anchor="w")  
        self.pb\_current \= ttk.Progressbar(body, orient="horizontal", length=100, mode="determinate")  
        self.pb\_current.pack(fill="x", pady=(5, 5))  
          
        self.lbl\_status \= tk.Label(body, text="ì„¤ì¹˜ ì¤€ë¹„ ì™„ë£Œ", font=("Malgun Gothic", 10, "bold"), fg="\#2980b9", bg="\#f5f6fa")  
        self.lbl\_status.pack(pady=10)  
          
        \# \- \*\*'ì„¤ì¹˜ GUI' íŒŒì¼ì„ ì‹¤í–‰í•˜ë©´, \[í´ë” ìƒì„± \-\> íŒŒì¼ ìƒì„± \-\> í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ ìë™ ë‹¤ìš´ë¡œë“œ ë° ì„¤ì¹˜\] ê¹Œì§€ ì›í´ë¦­ ì§„í–‰\*\*  
        self.btn\_install \= tk.Button(body, text="ì„¤ì¹˜ ì‹œì‘ (Install)", command=self.start\_install, bg="\#27ae60", fg="white", font=("Malgun Gothic", 14, "bold"), relief="flat", height=2)  
        self.btn\_install.pack(fill="x", pady=10)

    def change\_dir(self):  
        d \= filedialog.askdirectory()  
        if d: self.install\_dir.set(os.path.join(d, "PDF\_Indexer\_v42"))

    def start\_install(self):  
        self.btn\_install.config(state="disabled", text="ì„¤ì¹˜ ì§„í–‰ ì¤‘...")  
        threading.Thread(target=self.run\_install, daemon=True).start()

    def run\_install(self):  
        try:  
            target \= self.install\_dir.get()  
            venv \= os.path.join(target, "venv")  
            python\_exe \= sys.executable  
              
            \# 1\. Folder Creation  
            self.update\_status(0, 0, "í´ë” ìƒì„± ì¤‘...")  
            os.makedirs(target, exist\_ok=True)  
            self.update\_status(10, 100, "í´ë” ìƒì„± ì™„ë£Œ")  
            time.sleep(0.5)

            \# 2\. File Creation  
            self.update\_status(10, 0, "ì‹¤í–‰ í”„ë¡œê·¸ë¨ ìƒì„± ì¤‘...")  
            \# \- \*\*ì‚¬ìš©ìëŠ” ì„¤ì¹˜ íŒŒì¼ë§Œ ì‹¤í–‰, ë‚˜ë¨¸ì§€ ì„¤ì¹˜ ê³¼ì •ì€ íŒŒì´ì¬ ì½”ë“œê°€ ìë™ìœ¼ë¡œ ì§„í–‰\*\*  
            with open(os.path.join(target, "pdf\_indexer\_app.pyw"), "w", encoding="utf-8") as f:  
                f.write(RUNNER\_SOURCE)  
            self.update\_status(20, 100, "ì‹¤í–‰ í”„ë¡œê·¸ë¨ ìƒì„± ì™„ë£Œ")  
            time.sleep(0.5)

            \# 3\. VENV Creation  
            self.update\_status(20, 0, "ë…ë¦½ ê°€ìƒí™˜ê²½(VENV) êµ¬ì¶• ì¤‘...")  
            proc \= subprocess.Popen(\[python\_exe, "-m", "venv", venv\], shell=True)  
            while proc.poll() is None:  
                self.pb\_current.step(2)  
                time.sleep(0.1)  
            self.update\_status(40, 100, "ê°€ìƒí™˜ê²½ êµ¬ì¶• ì™„ë£Œ")

            venv\_python \= os.path.join(venv, "Scripts", "python.exe")  
              
            \# 4\. Lib Install (Safe Mode)  
            \# \- \*\*ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì„¤ì¹˜ë˜ëŠ” ê³¼ì •ì„ ê²€ì€ìƒ‰ CMD ì°½ì´ ì•„ë‹Œ, 'ì„¤ì¹˜ GUI' ë¡œë”© ì°½(Progress Bar)ìœ¼ë¡œ í‘œí˜„\*\*  
            self.update\_status(40, 0, "PIP ì—…ë°ì´íŠ¸ ì²´í¬...")  
            try:  
                subprocess.run(\[venv\_python, "-m", "pip", "install", "--upgrade", "pip"\], shell=True, check=False)  
            except: pass  
            self.update\_status(50, 100, "ì„¤ì • ì™„ë£Œ (PIP)")

            \# \- \*\*ëª¨ë“  ì„¤ì¹˜ ê³¼ì •ì€ í•­ëª© ë³„ë¡œ ì´ ì‘ì—…ëŸ‰ ëŒ€ë¹„ í˜„ì¬ ì‘ì—…ëŸ‰ì„ í¼ì„¼í‹°ì§€í™” í•˜ì—¬ ì§„ì²™ë¥ ì„ í™•ì¸í•  ìˆ˜ ìˆëŠ” ì‹œê°ì  ì´ë¯¸ì§€ ì ìš©\*\*  
            self.update\_status(50, 0, "GPU ì—”ì§„(Torch) ë° ëª¨ë‹ˆí„°ë§ ë„êµ¬ ì„¤ì¹˜ ì¤‘...")  
            proc \= subprocess.Popen(\[venv\_python, "-m", "pip", "install", "torch", "torchvision", "torchaudio", "psutil", "--index-url", "https://download.pytorch.org/whl/cu121"\], shell=True)  
            while proc.poll() is None:  
                self.pb\_current.step(0.5)  
                time.sleep(0.1)  
            self.update\_status(75, 100, "GPU ì—”ì§„ ì„¤ì¹˜ ì™„ë£Œ")

            self.update\_status(75, 0, "ë¬¸ì„œ ì²˜ë¦¬ ì—”ì§„(Docling) ì„¤ì¹˜ ì¤‘...")  
            subprocess.run(\[venv\_python, "-m", "pip", "install", "docling", "pillow"\], shell=True, check=True)  
            self.update\_status(90, 100, "ë¬¸ì„œ ì—”ì§„ ì„¤ì¹˜ ì™„ë£Œ")

            \# 5\. Shortcut & VBS Generation (Ghost Launcher)  
            self.update\_status(90, 0, "ë¬´ì¤‘ë‹¨ ëŸ°ì²˜(VBS) ìƒì„± ì¤‘...")  
            venv\_pyw \= os.path.join(venv, "Scripts", "pythonw.exe")  
              
            \# BAT file (Logic)  
            bat\_content \= f'''@echo off  
:loop  
echo \[System\] í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•©ë‹ˆë‹¤...  
"{venv\_pyw}" "{os.path.join(target, "pdf\_indexer\_app.pyw")}"  
if %errorlevel% neq 0 (  
    echo.  
    echo \[System\] ì˜¤ë¥˜ë¡œ ì¸í•´ ë¹„ì •ìƒ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. (5ì´ˆ í›„ ìë™ ì¬ì‹œì‘)  
    timeout /t 5  
    goto loop  
)  
echo.  
echo \[System\] í”„ë¡œê·¸ë¨ì´ ì •ìƒì ìœ¼ë¡œ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.  
'''  
            with open(os.path.join(target, "RUN\_INDEXER.bat"), "w", encoding="cp949") as f:  
                f.write(bat\_content)

            \# VBS file (Ghost Wrapper)  
            vbs\_content \= f'''Set WshShell \= CreateObject("WScript.Shell")   
WshShell.Run chr(34) & "{os.path.join(target, "RUN\_INDEXER.bat")}" & chr(34), 0  
Set WshShell \= Nothing  
'''  
            with open(os.path.join(target, "ì‹¤í–‰í•˜ê¸°(ë¬´ì¤‘ë‹¨).vbs"), "w", encoding="cp949") as f:  
                f.write(vbs\_content)

            \# \- \*\*ê²°ê³¼ íŒŒì¼ì€ ì§€ì • ëœ ì„¤ì¹˜ í´ë”ì— í•˜ìœ„í´ë” ì—†ì´ ì €ì¥\*\*  
            self.update\_status(100, 100, "ì„¤ì¹˜ ì™„ë£Œ\!")

            \# \- \*\*ì„¤ì¹˜ê°€ ì™„ë£Œ í›„, ì„¤ì¹˜ëœ 'ì‹¤í–‰ GUI' íŒŒì¼ë¡œ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰\*\*  
            messagebox.showinfo("ì„¤ì¹˜ ì„±ê³µ", f"ì„¤ì¹˜ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤\!\\n\\n\[{target}\]\\ní´ë” ì•ˆì˜ 'ì‹¤í–‰í•˜ê¸°(ë¬´ì¤‘ë‹¨).vbs'ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”.")  
            self.root.quit()

        except Exception as e:  
            self.update\_status(0, 0, "ì„¤ì¹˜ ì‹¤íŒ¨\!")  
            ctypes.windll.user32.MessageBoxW(0, f"ì˜¤ë¥˜ ë°œìƒ:\\n{str(e)}", "Error", 0x10)  
            self.btn\_install.config(state="normal", text="ì„¤ì¹˜ ì¬ì‹œë„")

    def update\_status(self, total\_val, current\_val, text):  
        self.root.after(0, lambda: \[  
            self.pb\_total.configure(value=total\_val),  
            self.pb\_current.configure(value=current\_val),  
            self.lbl\_status.configure(text=text)  
        \])

if \_\_name\_\_ \== "\_\_main\_\_":  
    try:  
        root \= tk.Tk()  
        app \= InstallerGUI(root)  
        root.mainloop()  
    except Exception as e:  
        ctypes.windll.user32.MessageBoxW(0, f"Critical Error:\\n{str(e)}", "Fail", 0x10)  


## 11) ì„¤ì¹˜ í”„ë¡œê·¸ë¨ ë¬´ë°˜ì‘(í´ë¦­í•´ë„ ë°˜ì‘ ì—†ìŒ) ëŒ€ì‘ ì ˆì°¨

1. í„°ë¯¸ë„ì—ì„œ ì§ì ‘ ì‹¤í–‰
```bash
python install_manager.pyw
```

2. Python ê²½ë¡œ ì ê²€
```bash
python --version
where python
```

3. íŒŒì¼ ì—°ê²° ì¬ì§€ì •
- `install_manager.pyw` ìš°í´ë¦­ â†’ ì—°ê²° í”„ë¡œê·¸ë¨ â†’ `pythonw.exe`/`python.exe`

4. ë³´ì•ˆ ì •ì±… í™•ì¸
- íŒŒì¼ ì†ì„±ì˜ ì°¨ë‹¨ í•´ì œ
- ë°±ì‹ /Defender ê²©ë¦¬ ì—¬ë¶€ ì ê²€

5. ì„¤ì¹˜ê¸° import ì ê²€
- ì„¤ì¹˜ê¸°ì—ëŠ” í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë§Œ import
- `psutil`, `torch`, `docling` importëŠ” ì‹¤í–‰ê¸°ë¡œ ì´ë™

6. ë¶€íŠ¸ ë¡œê·¸ ìˆ˜ì§‘
```bash
python install_manager.pyw > installer_boot.log 2>&1
```
- ì²« Traceback ë¼ì¸ì„ ê¸°ì¤€ìœ¼ë¡œ ì›ì¸ ì¡°ì¹˜
